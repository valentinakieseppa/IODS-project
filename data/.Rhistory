type="l",
lwd=3,
lty=3,
col="turquoise2")
AGE_RANGE <- seq(from=min(dataset$AGE), to=max(dataset$AGE), by=1)
im_logit <- b0 + x1*1 + x2*AGE_RANGE + x1.x1*1*AGE_RANGE
con_logit <- b0 + x2*AGE_RANGE
im_probs <- exp(im_logit)/(1 + exp(im_logit))
con_probs <- exp(con_logit)/(1 + exp(con_logit))
plot(AGE_RANGE, im_probs,
ylim=c(0,1),
type="l",
lwd=3,
lty=2,
col="gold",
xlab="x2", ylab="P(outcome)", main="Immigrants and controls")
lines(AGE_RANGE, con_probs,
type="l",
lwd=3,
lty=3,
col="turquoise2")
library(foreign)
file.choose()
dataset = read.spss("V:\\KEMI_maamu\\VALENTINA\\Valentina_Maamu_Karsittu.sav", to.data.frame=TRUE)
dataset$recode_YHTKPLU_2 <- relevel(dataset$recode_YHTKPLU, ref = "more than 10 visits")
dataset$recode_SEX <- relevel(dataset$SEX, ref = "nainen")
dataset$recode_VERRONO <- relevel(dataset$VERRONO, ref = "verrokki")
dataset$recode_SIVIILI_2 <- relevel(dataset$rec_SIVIILI_2LK, ref = "Single")
dataset$rec_age <- relevel(dataset$rec_age, ref = ">60")
dataset$rec_SES_uusin <- relevel(dataset$rec_SES_uusin, ref = "Upper white collar workers")
model1 <- multinom(recode_YHTKPLU_2 ~ recode_VERRONO + rec_age + recode_SEX +
recode_SIVIILI_2 + rec_SES_uusin +
recode_VERRONO:rec_age, data = dataset)
summary(model1)
library (stargazer)
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , ci = TRUE, ci.level = 0.95, single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , apply.coef=exp, ci = TRUE, ci.level = 0.95, single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , apply.coef=exp, ci = TRUE, single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , apply.coef=exp, ci = TRUE, single.row = TRUE, out=
"models.htm")
z <- summary(model1)$coefficients/summary(model1)$standard.errors
p <- (1 - pnorm(abs(z), 0, 1))*2
p
exp(coef(model1))
exp(confint(model1))
summary(model1)$coefficients
exp(0.54973476 + 1.96 * 0.2491341)
exp(0.54973476 - 1.96 * 0.2491341)
exp(cbind("Odds ratio" = coef(model1), confint.default(model1, level = 0.95)))
odds.ratio(summary(model1)$coefficients, level = 0.95)
exp(summary(model1)$coefficients, level = 0.95)
ci(summary(model1)$coefficients, confidence=0.95, alpha=1 - confidence)
OR <- exp(coef(model1))
OR
confint(?)
confint?
help(confint)
help(confint)
confint(OR, level = 0.95)
confint(exp(coef(model1)), level = 0.95)
exp(confint(model1))
confint(model1, level = 0.95)
exp(confint(model1))
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
apply.coef=exp, ci = TRUE, single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
apply.coef=exp, ci = TRUE, single.row = TRUE, out=
"models.htm")
help(stargazer)
stargazer(model2, title = "Results of a multinomial regression analysis",
dep.var.labels = c("1-3 visits", "4-10 visits"),
covariate.labels = c("Age", "Male", "less than 5 years",
"5-15 years"), no.space = TRUE,
align = TRUE, apply.coef=exp, ci = TRUE, ci.level = 0.95, apply.ci = exp,
type = "latex", out = "modeltest.tex")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
apply.coef=exp, ci = TRUE, apply.ci = exp, single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, apply.ci = exp, single.row = TRUE, out=
"models.htm")
stargazer(model1, type= "html", out= "modelss.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, apply.ci = exp, apply.coef=exp, single.row = TRUE, out=
"models.htm")
OR <- exp(coef(model1))
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, apply.ci = exp, coef=list(OR), single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, apply.ci = exp, single.row = TRUE, out=
"models.htm")
ORexp <- exp(coef(model1))
ORexp
ORcon <- exp(confint(model1))
ORcon
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, ci.custom = list(ORcon), single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, ci.custom = list(ORcon), ci = T, ci.level = 0.95, ci.separator = ";", single.row = TRUE, out=
"models.htm")
stargazer(model1, type="html", title =
"Results of multinomial logistic regression analysis", align =
TRUE , dep.var.labels = c("Inadequate treatment (1-3)", "Minimally adequate treatment (4-10)"),
covariate.labels = c("Immigrant", "Age 15-30", "Age 30-45", "Age 45-60",
"Male", "Married/registered partnership", "Entrepreuners and farmers",
"Lower white collar workers", "Blue collar workers", "Others",
"Immigrant*Age 15-30", "Immigrant*Age 30-45", "Immigrant*Age 45-60"),
ci = TRUE, ci.custom = list(ORcon), ci.level = 0.95, ci.separator = ";", single.row = TRUE, out=
"models.htm")
library(foreign)
file.choose()
dataset = read.spss("V:\\KEMI_maamu\\VALENTINA\\Valentina_Maamu_Karsittu.sav", to.data.frame=TRUE)
library(nnet)
dataset$recode_YHTKPLU_2 <- relevel(dataset$recode_YHTKPLU, ref = "more than 10 visits")
dataset$recode_SEX <- relevel(dataset$SEX, ref = "nainen")
dataset$recode_VERRONO <- relevel(dataset$VERRONO, ref = "verrokki")
dataset$recode_SIVIILI_2 <- relevel(dataset$rec_SIVIILI_2LK, ref = "Single")
dataset$rec_age <- relevel(dataset$rec_age, ref = ">60")
dataset$rec_SES_uusin <- relevel(dataset$rec_SES_uusin, ref = "Upper white collar workers")
model1 <- multinom(recode_YHTKPLU_2 ~ recode_VERRONO + rec_age + recode_SEX +
recode_SIVIILI_2 + rec_SES_uusin +
recode_VERRONO:rec_age, data = dataset)
summary(model1)
z <- summary(model1)$coefficients/summary(model1)$standard.errors
z
p <- (1 - pnorm(abs(z), 0, 1)) * 2
p
exp(coef(test))
exp(coef(model1))
head(pp <- fitted(model1))
dataset$VERRONO
predict(model1,dataset,"probs")
head(pp <- fitted(model1))
help("data.frame")
predicted_class <- predict (model1, test)
predicted_class <- predict (model1, dataset)
predicted_class
library(tidyverse)
plot(recode_VERRONO, recode_YHTKPLU_2,xlab="Immigrant",ylab="Probability of ?")
plot(dataset$recode_VERRONO, dataset$recode_YHTKPLU_2,xlab="Immigrant",ylab="Probability of ?") # plot with body size on x-axis and survival (0 or 1) on y-axis
curve(predict(model1,data.frame(recode_VERRONO=x),type="resp"),add=TRUE)
b0 <- 1.08781715
x1 <- 0.54973476
a1 <- -1.1346163
a2 <- -0.8465066
a3 <- -0.6804680
x2 <- 0.2750641
x3 <- -0.08210478
s1 <- 0.06122907
s2 <- -0.0408945
s3 <- -0.01939564
s4 <- 0.05767439
x1.a1 <- 0.0007493162
x1.a2 <- -0.3048804
x1.a3 <- -0.4162697
install.packages("rmarkdown")
learning2014 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep="\t", header=TRUE)
dim(learning2014)
?dim
learning2014
str(learning2014)
?str
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
deep_columns <- select(learning2014, one_of(deep_questions))
learning2014$deep <- rowMeans(deep_columns)
library(dplyr)
#Variable deep
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
deep_columns <- select(learning2014, one_of(deep_questions))
learning2014$deep <- rowMeans(deep_columns)
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
surface_columns <- select(learning2014, one_of(surface_questions))
learning2014$surf <- rowMeans(surface_columns)
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
strategic_columns <- select(learning2014, one_of(strategic_questions))
learning2014$stra <- rowMeans(strategic_columns)
#creating the dataset
keep_columns <- c("gender","Age","attitude", "deep", "stra", "surf", "Points")
new_learning2014 <- select(learning2014, one_of(keep_columns))
#Variable attitude
attitude_questions <- c("Da", "Db", "Dc", "Dd", "De", "Df", "Dg", "Dh", "Di", "Dj")
attitude_columns <- select(learning2014, one_of(attitude_questions))
learning2014$attitude <- rowMeans(attitude_columns)
keep_columns <- c("gender","Age","attitude", "deep", "stra", "surf", "Points")
new_learning2014 <- select(learning2014, one_of(keep_columns))
str(new_learning2014)
new_learning2014 <- select(learning2014, one_of(keep_columns),
filter(learning2014, points =! 0))
new_learning2014 <- select(learning2014, one_of(keep_columns),
filter(learning2014, Points =! 0))
new_learning2014 <- select(learning2014, one_of(keep_columns),
filter(learning2014, Points != 0))
final_learning2014 <-  filter(new_learning2014, Points != 0))
final_learning2014 <-  filter(new_learning2014, Points != 0)
dim(learning2014)
dim(final_learning2014)
final_learning2014
#Valentina Kieseppä
#7.11.2018
#Analysis
#reading the data into R and exploring it's structure and dimensions
learning2014 <- read.table("learning2014.txt")
dim(learning2014)
str(learning2014)
#The data has 166 rows (observations) and 7 columns (variables). One of the variables, gender, is a factor with two levels.
#Others, including age, attitude, deep, stra, surf and points, are numeric.
#Visualizing the data and inspecting summeries of the variables
library(GGally)
library(ggplot2)
my_graph <- ggpairs(learning2014, mapping = aes(col = gender, alpha = 0.3),
lower = list(combo = wrap("facethist", bins = 20)))
summary(learning2014)
#The dataset includes much more women (110) than men (56). Age ranges from 17 to 55, with a 25.51 as the mean age,
#so the age distribution is strongly skewed on left. (Men seem to be slightlty older than women).
#Scores on the Points variable ranged from 7 to 33 with a mean of 22.73.
#Other variables, including attitude (mean=3.14), deep (mean=3.12), stra (mean=3.12) and surf (mean=2.79)
#ranged from 1 to 5 since they were measured on a Likert-scale. There was a somewhat strong correlation
#between points and attitude (0.44). There was also a correlation between surf and deep (-0.32),
#although this correlation seemed strong only in men (-0.62) and pretty much nonexistet in women (-0.09). Men also
#had a correlation between surf and attitude (-0.37), but this didn't appear for women (-0.015).
#Fitting a regression line and showing the summary
the_model <- lm(Points ~ attitude + stra + surf, data = learning2014)
summary(the_model)
#Comments on the regression analysis: Only the variable "attitude" explained changes in "Points" significantly
#(B=3.4, p < 0.001). Stra (B=0.85, p = 0.18) and surf (B=-0.59, p=0.47) weren't significant predictors, so they
#will be removed in the next analysis.
the_better_model <- lm (Points ~ attitude, data = learning2014)
summary(the_better_model)
#Attitude significantly explains Points (B=3.53, p < 0.001). Higher scores on attitude predict
#higher scores on Points. Multiple R-squared of 0.19 means that this model explains about 19% of all the variaton -
#meaning basically, that changes in attitude explain about 19% of changes in Points - I think it's quite a lot!
#(Although generally R-squared of 0.19 would be regarded as quite low.)
setwd("\\\\helfs01.thl.fi/homes/vkif/_Documents/Uusi kansio/IODS-project")
#reading the data into R and exploring it's structure and dimensions
learning2014 <- read.table("learning2014.txt")
dim(learning2014)
str(learning2014)
#The data has 166 rows (observations) and 7 columns (variables). One of the variables, gender, is a factor with two levels.
#Others, including age, attitude, deep, stra, surf and points, are numeric.
#Visualizing the data and inspecting summeries of the variables
library(GGally)
library(ggplot2)
my_graph <- ggpairs(learning2014, mapping = aes(col = gender, alpha = 0.3),
lower = list(combo = wrap("facethist", bins = 20)))
summary(learning2014)
#The dataset includes much more women (110) than men (56). Age ranges from 17 to 55, with a 25.51 as the mean age,
#so the age distribution is strongly skewed on left. (Men seem to be slightlty older than women).
#Scores on the Points variable ranged from 7 to 33 with a mean of 22.73.
#Other variables, including attitude (mean=3.14), deep (mean=3.12), stra (mean=3.12) and surf (mean=2.79)
#ranged from 1 to 5 since they were measured on a Likert-scale. There was a somewhat strong correlation
#between points and attitude (0.44). There was also a correlation between surf and deep (-0.32),
#although this correlation seemed strong only in men (-0.62) and pretty much nonexistet in women (-0.09). Men also
#had a correlation between surf and attitude (-0.37), but this didn't appear for women (-0.015).
#Fitting a regression line and showing the summary
the_model <- lm(Points ~ attitude + stra + surf, data = learning2014)
summary(the_model)
#Comments on the regression analysis: Only the variable "attitude" explained changes in "Points" significantly
#(B=3.4, p < 0.001). Stra (B=0.85, p = 0.18) and surf (B=-0.59, p=0.47) weren't significant predictors, so they
#will be removed in the next analysis.
the_better_model <- lm (Points ~ attitude, data = learning2014)
summary(the_better_model)
#Attitude significantly explains Points (B=3.53, p < 0.001). Higher scores on attitude predict
#higher scores on Points. Multiple R-squared of 0.19 means that this model explains about 19% of all the variaton -
#meaning basically, that changes in attitude explain about 19% of changes in Points - I think it's quite a lot!
#(Although generally R-squared of 0.19 would be regarded as quite low.)
plot(the_better_model, which = c(1,2,5))
getwd()
setwd("\\\\helfs01.thl.fi/homes/vkif/_Documents/Uusi kansio/IODS-project/data")
alc <- read.csv("alc.csv", sep = ",", header = TRUE, row.names = 1)
str(alc)
.35
cor(alc)
str(alc)
cor(alc)
cor.test(alc$high_use, alc$G3, alc$absences, alc$health, alc$failures,alc$sex, alc$age
alc$method = "pearson")
cor.test(alc$high_use, alc$G3, alc$absences, alc$health, alc$failures,alc$sex, alc$age,
alc$method = "pearson")
cor.test(alc$high_use, alc$G3, alc$absences, alc$health, alc$failures,alc$sex, alc$age,
method = "pearson")
table(alc$high_use, alc$G3, alc$health, alc$absences, alc$failures, alc$age, alc$sex)
table(alc$high_use, alc$sex)
table(alc$high_use, alc$sex) %>% prob.table()
library(tidyr); library(dplyr); library(ggplot2)
table(alc$high_use, alc$sex) %>% prob.table()
table(alc$high_use, alc$sex) %>% prop.table()
summary(alc$failures)
alc$failures
table(alc$high_use, alc$failures)
table(alc$high_use, alc$failures) %>% prop.table()
table(alc$high-use, alc$absences) %>% prop.table()
table(alc$high_use, alc$absences) %>% prop.table()
g1 <- ggplot(alc, aes(x = high_use, y = failures))
g1 + geom_boxplot()
g1 <- ggplot(alc, aes(x = high_use, y = age))
g1 + geom_boxplot()
g1 <- ggplot(alc, aes(x = high_use, y = sex))
g1 + geom_line()
g1 <- ggplot(alc, aes(x = high_use, y = sex))
g1 + geom_bar()
g1 <- ggplot(alc, aes(x = high_use, y = sex))
g1 + geom_bar()
table1 <- table(alc$high_use, alc$sex) %>% prop.table()
counts <- table(alc$high_use, alc$sex) %>% prop.table()
counts <- table(alc$sex)
barplot(counts, xlab=sex)
g1 <- ggplot(alc, aes(x = high_use, y = absences))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x=high_use, y = age)
g2 + geom_boxplot()
g2 <- ggplot(alc, aes(x=high_use, y = age))
g2 + geom_boxplot()
cor(alc$age, alc$high_use)
summary(high_use)
summary(alc$high_use)
cor(alc$age, alc$high_use)
cor(alc$absences, alc$high_use)
model1 <- glm(data=alc, high_use ~ failures + absences + age + sex, family = "binomial")
summary(model1)
coef(model1)
#odds ratios
OR <- coef(model1) %>% exp
#confidence intervals
CI <- confint(model1) %>% exp
cbind(OR, CI)
#summary of the model
summary(model1)
#reading the data
setwd("\\\\helfs01.thl.fi/homes/vkif/_Documents/Uusi kansio/IODS-project/data")
alc <- read.csv("alc.csv", sep = ",", header = TRUE, row.names = 1)
str(alc)
library(tidyr); library(dplyr); library(ggplot2)
##Crosstabultion of the relationship between high_use and sex and high_use and failures.
table(alc$high_use, alc$sex) %>% prop.table()
table(alc$high_use, alc$failures) %>% prop.table()
#Box plots of the relationship between high_use and absences and high_use and age
g1 <- ggplot(alc, aes(x = high_use, y = absences))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x=high_use, y = age))
g2 + geom_boxplot()
#Okey, we can see that male sex, absences and failures are all related to higher
#alcohol consumption. Older age however seems to be related to higher alcohol consumption.
#Fitting the logistic regression model
model1 <- glm(data=alc, high_use ~ failures + absences + age + sex, family = "binomial")
#summary of the model
summary(model1)
#coefficients
coef(model1)
#odds ratios
OR <- coef(model1) %>% exp
#confidence intervals
CI <- confint(model1) %>% exp
cbind(OR, CI)
#Okay, from the summary we can already see that absences and sex are strong predictors
#for the alcohol conspumption (high p-value) and failures seems to be significant
#predictor as well, although with slightly lower p-value (p=0.036). OR for Male sex is
#2.58 , meaning that men are over two times more likely than women to be in the
#"high_use"-group. High value for failures increases the likelihood of higher use of
#alcohol as well (OR = 1.5), as does high value for absences (OR = 1.09).
# calculating the predicted probabilites for "high_use" and adding those predicted
#probabilites to the dataset
probabilities <- predict(model1, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, alc$probability)
loss_func(class = alc$high_use, prob = 0)
loss_func(class = alc$high_use, prob = 0.5)
loss_func(class = alc$high_use, prob = 1)
loss_func(class = alc$high_use, prob = 0)
loss_func(class = alc$high_use, prop = 1)
loss_func(class = alc$high_use, prob = 0)
loss_func(class = alc$high_use, prob = 1)
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model1, K = 10)
cv$delta[1]
g1 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g1 + geom_boxplot()
g2 <- ggplot(alc, aes(x=high_use, y = age, col = sex))
g2 + geom_boxplot()
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model1, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model1, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model1, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model1, K = 10)
cv$delta[1]
colnames(alc)
model1 <- glm(data=alc, high_use ~ failures + absences + sex, family = "binomial")
summary(model1)
OR <- coef(model1) %>% exp
CI <- confint(model1) %>% exp
cbind(OR, CI)
259/268
30/114
(9+84)/382
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
model2 <- glm(data=alc, high_use ~ failures + absences + sex, family = "binomial")
summary(model2)
OR <- coef(model2) %>% exp
CI <- confint(model2) %>% exp
cbind(OR, CI)
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = model2, K = 10)
cv$delta[1]
